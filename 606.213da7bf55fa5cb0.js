"use strict";(self.webpackChunkportfolio=self.webpackChunkportfolio||[]).push([[606],{1606:(Z,c,l)=>{l.r(c),l.d(c,{EndlessDungeonCrawlerModule:()=>y});var p=l(467),n=l(4438),u=l(4341);const f=["endlessCrawlerCanvas"];let w=(()=>{class a{constructor(){this.simulationStepCount=5,this.threshold=5,this.propability=50,this.SIZE=150,this.position={x:0,y:0},this.BOTTOM_COLOR=[245,245,220,255],this.STONE_COLOR=[158,74,74,255],this.PIXEL_SIZE=16,this.dungeon=[]}ngAfterViewInit(){this.canvasContext=this.endlessCrawlerCanvas?.nativeElement.getContext("2d")}ngOnDestroy(){this.dungeonBitMap?.close()}onStart(){this.dungeon=[],this.generateDungeonPart({x:0,y:0,w:this.SIZE,h:this.SIZE}),this.constructBitmap().then(()=>this.drawCanvas())}generateDungeonPart(e){this.sprinkleOnDungeon(e),this.simulateCA(e)}sprinkleOnDungeon(e){for(let t=e.x;t<e.x+e.w;t++)for(let o=e.y;o<e.y+e.h;o++)this.dungeon[t+o*this.SIZE]=Math.random()<=.01*this.propability?1:0}simulateCA(e){for(let t=0;t<this.simulationStepCount;t++){const o=[...this.dungeon];for(let i=e.x;i<e.x+e.w;i++)for(let r=e.y;r<e.y+e.h;r++){const s=i+r*this.SIZE;let d=0;for(let h=-1;h<=1;h++)for(let g=-1;g<=1;g++){let E=s+g+h*this.SIZE;E=(E+this.SIZE*this.SIZE)%(this.SIZE*this.SIZE),this.dungeon[E]&&d++}o[s]=d>=this.threshold?1:0}this.dungeon=o}}shiftDungeon(e,t){for(let o=0;o<this.dungeon.length;o++)o/this.SIZE+t>=this.SIZE||o/this.SIZE+t<0||o%this.SIZE+e>=this.SIZE||o%this.SIZE+e<0||(this.dungeon[o]=this.dungeon[o+e+t*this.SIZE])}constructBitmap(){var e=this;return(0,p.A)(function*(){const t=new Uint8ClampedArray(4*e.SIZE*e.SIZE);for(let s=0;s<e.dungeon.length;s++){const h=1===e.dungeon[s]?e.STONE_COLOR:e.BOTTOM_COLOR;t[4*s+0]=h[0],t[4*s+1]=h[1],t[4*s+2]=h[2],t[4*s+3]=h[3]}const o=new ImageData(t,e.SIZE,e.SIZE),i=e.SIZE*e.PIXEL_SIZE,r={resizeHeight:i,resizeQuality:"pixelated",resizeWidth:i};e.dungeonBitMap?.close(),e.dungeonBitMap=yield createImageBitmap(o,0,0,e.SIZE,e.SIZE,r)})()}drawCanvas(){const e=this.SIZE*this.PIXEL_SIZE;this.canvasContext.drawImage(this.dungeonBitMap,-e/3-this.position.x*this.PIXEL_SIZE,-e/3-this.position.y*this.PIXEL_SIZE)}move(e){var t=this;return(0,p.A)(function*(){if(t.dungeonBitMap){switch(e.key){case"ArrowLeft":t.position.x--;break;case"ArrowRight":t.position.x++;break;case"ArrowUp":t.position.y--;break;case"ArrowDown":t.position.y++}(Math.abs(t.position.x)>=t.SIZE/3||Math.abs(t.position.y)>=t.SIZE/3)&&(yield t.generateBorderAndResetShift()),t.drawCanvas()}})()}generateBorderAndResetShift(){var e=this;return(0,p.A)(function*(){if(Math.abs(e.position.x)>=e.SIZE/3){const t={x:e.position.x+e.SIZE/3,y:0,w:e.SIZE/3,h:e.SIZE};e.shiftDungeon(1*e.position.x,0),e.generateDungeonPart(t),e.position.x>=e.SIZE/3?e.position.x-=e.SIZE/3:e.position.x+=e.SIZE/3}if(Math.abs(e.position.y)>=e.SIZE/3){const t={x:0,y:e.position.y+e.SIZE/3,w:e.SIZE,h:e.SIZE/3};e.shiftDungeon(0,1*e.position.y),e.generateDungeonPart(t),e.position.y>=e.SIZE/3?e.position.y-=e.SIZE/3:e.position.y+=e.SIZE/3}yield e.constructBitmap()})()}static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275cmp=n.VBU({type:a,selectors:[["app-endless-dungeon-crawler"]],viewQuery:function(t,o){if(1&t&&n.GBs(f,5),2&t){let i;n.mGM(i=n.lsd())&&(o.endlessCrawlerCanvas=i.first)}},hostBindings:function(t,o){1&t&&n.bIt("keydown.arrowup",function(r){return o.move(r)},!1,n.tSv)("keydown.arrowdown",function(r){return o.move(r)},!1,n.tSv)("keydown.arrowright",function(r){return o.move(r)},!1,n.tSv)("keydown.arrowleft",function(r){return o.move(r)},!1,n.tSv)},decls:37,vars:11,consts:[["endlessCrawlerCanvas",""],[1,"was-validated"],[1,"input-group","is-invalid",2,"width","10rem","display","inline-flex"],["type","number",1,"form-control",3,"ngModelChange","ngModel","min","max"],["type","number",1,"form-control",3,"ngModelChange","ngModel","min"],[1,"mb-5"],["type","button",1,"btn","btn-outline-primary",3,"click"],[2,"height","2rem"]],template:function(t,o){if(1&t){const i=n.RV6();n.j41(0,"h1"),n.EFF(1," Endless Dungeon Crawler\n"),n.k0s(),n.j41(2,"p"),n.EFF(3," This is a endless dungeon crawler using procedural ocntent generation to generate the dungeon.\n"),n.k0s(),n.j41(4,"p"),n.EFF(5," For this I will create a rendom placement of stones in a 2D dungeon to create a cave. To get results which look cavelike, I will use Cellular automate similar to the game of live to shift the stones.\n"),n.k0s(),n.j41(6,"p"),n.EFF(7," Therefore I have some rules you can change:\n"),n.k0s(),n.j41(8,"div",1)(9,"label"),n.EFF(10),n.j41(11,"span",2)(12,"input",3),n.mxI("ngModelChange",function(s){return n.eBV(i),n.DH7(o.propability,s)||(o.propability=s),n.Njj(s)}),n.k0s()(),n.EFF(13," percent. "),n.k0s(),n.j41(14,"label"),n.EFF(15," I will simulate "),n.j41(16,"span",2)(17,"input",4),n.mxI("ngModelChange",function(s){return n.eBV(i),n.DH7(o.simulationStepCount,s)||(o.simulationStepCount=s),n.Njj(s)}),n.k0s()(),n.EFF(18," steps of the cellular automata. "),n.k0s(),n.j41(19,"p"),n.EFF(20," For each step the following rules apply to perform a simulation step: "),n.k0s(),n.j41(21,"label"),n.EFF(22," An empty field will turn into a rock if at least "),n.j41(23,"strong"),n.EFF(24,"T"),n.k0s(),n.EFF(25," = "),n.j41(26,"span",2)(27,"input",3),n.mxI("ngModelChange",function(s){return n.eBV(i),n.DH7(o.threshold,s)||(o.threshold=s),n.Njj(s)}),n.k0s()(),n.EFF(28," neighbors are filled with rocks, otherwise it will turn into an empty field. "),n.k0s(),n.j41(29,"p"),n.EFF(30," Now try it! Use arrow keys to navigate through the endless cave! "),n.k0s()(),n.j41(31,"p",5)(32,"button",6),n.bIt("click",function(){return n.eBV(i),n.Njj(o.onStart())}),n.EFF(33," Start: "),n.k0s()(),n.nrm(34,"canvas",null,0)(36,"p",7)}2&t&&(n.R7$(10),n.SpI(" At the beginning I will fill a square size ",o.SIZE," with stones. The probabillity of a field to be a stone is: "),n.R7$(2),n.R50("ngModel",o.propability),n.Y8G("min",1)("max",99),n.R7$(5),n.R50("ngModel",o.simulationStepCount),n.Y8G("min",1),n.R7$(10),n.R50("ngModel",o.threshold),n.Y8G("min",0)("max",8),n.R7$(7),n.BMQ("width",o.SIZE*o.PIXEL_SIZE/3)("height",o.SIZE*o.PIXEL_SIZE/3))},dependencies:[u.me,u.Q0,u.BC,u.VZ,u.zX,u.vS],styles:[".dungeon-container[_ngcontent-%COMP%]{display:grid;width:1200px;height:1200px;grid-template-columns:400px 400px 400px}.dungeon-part[_ngcontent-%COMP%]{width:400px;height:400px;display:flex;flex-wrap:wrap}.dungeon-part[_ngcontent-%COMP%]   .dungeon-cell[_ngcontent-%COMP%]{width:8px;height:8px;background-color:beige}.dungeon-part[_ngcontent-%COMP%]   .dungeon-cell.stone[_ngcontent-%COMP%]{background-color:#98764a}"]})}}return a})();var I=l(177),m=l(7513),C=l(4512);const S=[{path:"",component:w}];let y=(()=>{class a{static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275mod=n.$C({type:a})}static{this.\u0275inj=n.G2t({imports:[I.MD,u.YN,C.n8,m.iI.forChild(S),m.iI]})}}return a})()}}]);