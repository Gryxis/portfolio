"use strict";(self.webpackChunkportfolio=self.webpackChunkportfolio||[]).push([[172],{2172:(v,w,d)=>{function m(s,l,n,t,o,i,a){try{var r=s[i](a),u=r.value}catch(h){return void n(h)}r.done?l(u):Promise.resolve(u).then(t,o)}function p(s){return function(){var l=this,n=arguments;return new Promise(function(t,o){var i=s.apply(l,n);function a(u){m(i,t,o,a,r,"next",u)}function r(u){m(i,t,o,a,r,"throw",u)}a(void 0)})}}d.r(w),d.d(w,{EndlessDungeonCrawlerModule:()=>_});var e=d(4650),g=d(433);const Z=["endlessCrawlerCanvas"];let C=(()=>{class s{constructor(){this.simulationStepCount=5,this.threshold=5,this.propability=50,this.SIZE=150,this.position={x:0,y:0},this.BOTTOM_COLOR=[245,245,220,255],this.STONE_COLOR=[158,74,74,255],this.PIXEL_SIZE=16,this.dungeon=[]}ngAfterViewInit(){this.canvasContext=this.endlessCrawlerCanvas?.nativeElement.getContext("2d")}ngOnDestroy(){this.dungeonBitMap?.close()}onStart(){this.dungeon=[],this.generateDungeonPart({x:0,y:0,w:this.SIZE,h:this.SIZE}),this.constructBitmap().then(()=>this.drawCanvas())}generateDungeonPart(n){this.sprinkleOnDungeon(n),this.simulateCA(n)}sprinkleOnDungeon(n){for(let t=n.x;t<n.x+n.w;t++)for(let o=n.y;o<n.y+n.h;o++)this.dungeon[t+o*this.SIZE]=Math.random()<=.01*this.propability?1:0}simulateCA(n){for(let t=0;t<this.simulationStepCount;t++){const o=[...this.dungeon];for(let i=n.x;i<n.x+n.w;i++)for(let a=n.y;a<n.y+n.h;a++){const r=i+a*this.SIZE;let u=0;for(let h=-1;h<=1;h++)for(let c=-1;c<=1;c++){let f=r+c+h*this.SIZE;f=(f+this.SIZE*this.SIZE)%(this.SIZE*this.SIZE),this.dungeon[f]&&u++}o[r]=u>=this.threshold?1:0}this.dungeon=o}}shiftDungeon(n,t){for(let o=0;o<this.dungeon.length;o++)o/this.SIZE+t>=this.SIZE||o/this.SIZE+t<0||o%this.SIZE+n>=this.SIZE||o%this.SIZE+n<0||(this.dungeon[o]=this.dungeon[o+n+t*this.SIZE])}constructBitmap(){var n=this;return p(function*(){const t=new Uint8ClampedArray(4*n.SIZE*n.SIZE);for(let r=0;r<n.dungeon.length;r++){const h=1===n.dungeon[r]?n.STONE_COLOR:n.BOTTOM_COLOR;t[4*r+0]=h[0],t[4*r+1]=h[1],t[4*r+2]=h[2],t[4*r+3]=h[3]}const o=new ImageData(t,n.SIZE,n.SIZE),i=n.SIZE*n.PIXEL_SIZE,a={resizeHeight:i,resizeQuality:"pixelated",resizeWidth:i};n.dungeonBitMap?.close(),n.dungeonBitMap=yield createImageBitmap(o,0,0,n.SIZE,n.SIZE,a)})()}drawCanvas(){const n=this.SIZE*this.PIXEL_SIZE;this.canvasContext.drawImage(this.dungeonBitMap,-n/3-this.position.x*this.PIXEL_SIZE,-n/3-this.position.y*this.PIXEL_SIZE)}move(n){var t=this;return p(function*(){if(t.dungeonBitMap){switch(n.key){case"ArrowLeft":t.position.x--;break;case"ArrowRight":t.position.x++;break;case"ArrowUp":t.position.y--;break;case"ArrowDown":t.position.y++}(Math.abs(t.position.x)>=t.SIZE/3||Math.abs(t.position.y)>=t.SIZE/3)&&(yield t.generateBorderAndResetShift()),t.drawCanvas()}})()}generateBorderAndResetShift(){var n=this;return p(function*(){if(Math.abs(n.position.x)>=n.SIZE/3){const t={x:n.position.x+n.SIZE/3,y:0,w:n.SIZE/3,h:n.SIZE};n.shiftDungeon(1*n.position.x,0),n.generateDungeonPart(t),n.position.x>=n.SIZE/3?n.position.x-=n.SIZE/3:n.position.x+=n.SIZE/3}if(Math.abs(n.position.y)>=n.SIZE/3){const t={x:0,y:n.position.y+n.SIZE/3,w:n.SIZE,h:n.SIZE/3};n.shiftDungeon(0,1*n.position.y),n.generateDungeonPart(t),n.position.y>=n.SIZE/3?n.position.y-=n.SIZE/3:n.position.y+=n.SIZE/3}yield n.constructBitmap()})()}}return s.\u0275fac=function(n){return new(n||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-endless-dungeon-crawler"]],viewQuery:function(n,t){if(1&n&&e.Gf(Z,5),2&n){let o;e.iGM(o=e.CRH())&&(t.endlessCrawlerCanvas=o.first)}},hostBindings:function(n,t){1&n&&e.NdJ("keydown.arrowup",function(i){return t.move(i)},!1,e.Jf7)("keydown.arrowdown",function(i){return t.move(i)},!1,e.Jf7)("keydown.arrowright",function(i){return t.move(i)},!1,e.Jf7)("keydown.arrowleft",function(i){return t.move(i)},!1,e.Jf7)},decls:37,vars:11,consts:[[1,"was-validated"],[1,"input-group","is-invalid",2,"width","10rem","display","inline-flex"],["type","number",1,"form-control",3,"ngModel","min","max","ngModelChange"],["type","number",1,"form-control",3,"ngModel","min","ngModelChange"],[1,"mb-5"],["type","button",1,"btn","btn-outline-primary",3,"click"],["endlessCrawlerCanvas",""],[2,"height","2rem"]],template:function(n,t){1&n&&(e.TgZ(0,"h1"),e._uU(1," Endless Dungeon Crawler\n"),e.qZA(),e.TgZ(2,"p"),e._uU(3," This is a endless dungeon crawler using procedural ocntent generation to generate the dungeon.\n"),e.qZA(),e.TgZ(4,"p"),e._uU(5," For this I will create a rendom placement of stones in a 2D dungeon to create a cave. To get results which look cavelike, I will use Cellular automate similar to the game of live to shift the stones.\n"),e.qZA(),e.TgZ(6,"p"),e._uU(7," Therefore I have some rules you can change:\n"),e.qZA(),e.TgZ(8,"div",0)(9,"label"),e._uU(10),e.TgZ(11,"span",1)(12,"input",2),e.NdJ("ngModelChange",function(i){return t.propability=i}),e.qZA()(),e._uU(13," percent. "),e.qZA(),e.TgZ(14,"label"),e._uU(15," I will simulate "),e.TgZ(16,"span",1)(17,"input",3),e.NdJ("ngModelChange",function(i){return t.simulationStepCount=i}),e.qZA()(),e._uU(18," steps of the cellular automata. "),e.qZA(),e.TgZ(19,"p"),e._uU(20," For each step the following rules apply to perform a simulation step: "),e.qZA(),e.TgZ(21,"label"),e._uU(22," An empty field will turn into a rock if at least "),e.TgZ(23,"strong"),e._uU(24,"T"),e.qZA(),e._uU(25," = "),e.TgZ(26,"span",1)(27,"input",2),e.NdJ("ngModelChange",function(i){return t.threshold=i}),e.qZA()(),e._uU(28," neighbors are filled with rocks, otherwise it will turn into an empty field. "),e.qZA(),e.TgZ(29,"p"),e._uU(30," Now try it! Use arrow keys to navigate through the endless cave! "),e.qZA()(),e.TgZ(31,"p",4)(32,"button",5),e.NdJ("click",function(){return t.onStart()}),e._uU(33," Start: "),e.qZA()(),e._UZ(34,"canvas",null,6)(36,"p",7)),2&n&&(e.xp6(10),e.hij(" At the beginning I will fill a square size ",t.SIZE," with stones. The probabillity of a field to be a stone is: "),e.xp6(2),e.Q6J("ngModel",t.propability)("min",1)("max",99),e.xp6(5),e.Q6J("ngModel",t.simulationStepCount)("min",1),e.xp6(10),e.Q6J("ngModel",t.threshold)("min",0)("max",8),e.xp6(7),e.uIk("width",t.SIZE*t.PIXEL_SIZE/3)("height",t.SIZE*t.PIXEL_SIZE/3))},dependencies:[g.Fj,g.wV,g.JJ,g.qQ,g.Fd,g.On],styles:[".dungeon-container[_ngcontent-%COMP%]{display:grid;width:1200px;height:1200px;grid-template-columns:400px 400px 400px}.dungeon-part[_ngcontent-%COMP%]{width:400px;height:400px;display:flex;flex-wrap:wrap}.dungeon-part[_ngcontent-%COMP%]   .dungeon-cell[_ngcontent-%COMP%]{width:8px;height:8px;background-color:beige}.dungeon-part[_ngcontent-%COMP%]   .dungeon-cell.stone[_ngcontent-%COMP%]{background-color:#98764a}"]}),s})();var I=d(6895),E=d(2655),S=d(9837);const y=[{path:"",component:C}];let _=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[I.ez,g.u5,S.HK,E.Bz.forChild(y),E.Bz]}),s})()}}]);